<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>2DString</title>

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
  <style>
    .containerPic {
      text-align: center;
      width: 95%;
      margin: 50px auto;
    }

    .card {
      /* 定位點 */
      position: relative;
      width: 12.5%;
      float: left;
      /* margin: 0.5ch; */
    }

    img {
      display: block;
      width: 100%;
      height: auto;
    }

    .info {
      /*   display: none; */
      opacity: 0;
      position: absolute;
      box-sizing: border-box;
      background-color: rgba(0, 0, 0, .4);
      top: 0;
      width: 100%;
      height: 100%;
      text-align: center;
      padding-top: 40px;
    }

    .info p {
      color: #fff;
      margin-bottom: 0ch;
    }

    .info:hover {
      -webkit-transition: 500ms;
      opacity: 1;
    }

  </style>
</head>

<body class="bg-light">
  <nav class="navbar navbar-dark bg-dark">
    <a class="navbar-brand" href="#">
      Customize your own 2DString
    </a>
    <span class="navbar-text">
      This is a simple demo! Which makes you more convenient
    </span>
  </nav>

  <div class="container">
    <div class="row mt-3">
      <div class="col-md-8 mt-5">
        <h4 class="mb-3">Input</h4>
        <div class="row">
          <div class="col-md-12">
            <form class="needs-validation" novalidate action="score" method="post">{% csrf_token %}
                <label for="firstName">2DString X</label>
                {{ stringX }}
                <hr/>
                <label for="firstName">2DString Y</label>
                {{ stringY }}
            </form>
          </div>
        </div>
      </div>
      <div id="userPic" class="col-md-4">
      </div>
    </div>
  </div>

  <script>
    let date_data = "{{ resultDate }}".replaceAll('&#x27;', '').replaceAll('[', '').replaceAll(']', '').replaceAll(' ', '').split(',')
    let time_data = "{{ resultTime }}".replaceAll('&#x27;', '').replaceAll('[', '').replaceAll(']', '').replaceAll(' ', '').split(',')
    let content_data = "{{ resultContent }}".replaceAll('&#x27;', '').replaceAll('[', '').replaceAll(']', '').replaceAll(' ', '').split(',')
    console.log(date_data);
    console.log(time_data);
    console.log(content_data);
    var num = 0
    function getFileName(index) {
      return "/static/sis/" + date_data[index];
    }
    function getDate(index) {
      return date_data[index].substring(0, date_data[index].length-10);
    }
    function getTime(index) {
      return time_data[index];
    }
    function getContent(index) {
      return content_data[index];
    }
    console.log(getFileName(0));
    function getFileAllPath(fileName) {
      return "/static/sis/" + fileName + "_mix.png";
    }
    userPic = document.getElementById("userPic");
    console.log("{{ PicName }}");
    console.log(getFileAllPath("{{ PicName }}"));
    userPic.innerHTML += `<img src="${getFileAllPath("{{ PicName }}")}">`;
  </script>

  <!-- {% with ''|center:3 as rangeRow %}
  {% for _ in rangeRow %}
  <div class="containerPic">
    {% with num|center:8 as range %}
    {% for num in range %}
    <div class="card">
      <div class="info">
        
      </div>
    </div>
    {% endfor %}
    {% endwith %}
  </div>
  {% endfor %}
  {% endwith %} -->
  <div id="matchPic">
    </div>
  <div class="container">
    <div class="row" id="content">
    </div>
    <nav aria-label="Page navigation example">
       <ul class="pagination" id="pageid">
       </ul>
     </nav>
 </div>
  <div class="text-center">
    <button class="btn btn-outline-secondary m-5 btn btn-outline-secondary btn-lg" onclick="history.back(-1)">回上一頁</button>
  </div>
  <!-- <script src="vendor/jquery/jquery.min.js"></script> -->
  <!-- <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script> -->
  <script>
    console.log(num)
    let placeOfPic = document.getElementById("matchPic");
    for(let index = 0 ; index < 3;index ++){
      placeOfPic[index].innerHTML += `
      <div class="containerPic"></div>
      `;
      
    }
    let placeOfCard = document.getElementsByClassName("containerPic");
    for(let index = 0 ; index < 8;index ++){
      placeOfCard[index].innerHTML += `
        <div class="card"><div class="info"></div></div>
      `;
    }


    let elements = document.getElementsByClassName("card");
    for (let index = 0; index < elements.length; index++) {
      elements[index].innerHTML += `
      <img src="${getFileName(num)}">
      <p>${getDate(num)} ${getTime(num)} </p>
      <p><strong>Similarity:</strong> <br> ${getContent(num)}</p>
      `;
      num = num + 1;
    }
    let elementsInfo = document.getElementsByClassName("info");
    
    for (let index = 1; index <= elementsInfo.length; index++) {
      elementsInfo[index-1].innerHTML += `
      <button>View More</button>
      <p> NO. ${ index }</p>
      `;
    }
    const pageid = document.getElementById('pageid');
    console.log(pageid);
    // 用物件方式來傳遞資料
    const page = {
      dataTotal,
      currentPage,
      hasPage: currentPage > 1,
      hasNext: currentPage < dataTotal,
    }
    pageBtn(page);
    function pageBtn (page){
      let str = '';
      const total = page.dataTotal;
      
      for(let i = 0; i < total; i++){
        str +=`<li class="page-item"><a class="page-link" href="#">${i}</a></li>`;
      };
    
      pageid.innerHTML = str;
    }
  </script>
</body>

</html>
