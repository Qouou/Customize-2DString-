<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  {% load static %}
  <link rel="stylesheet" href="{% static '/css/qbe.css' %}">
  <link rel="stylesheet" href="{% static '/css/navbar.css' %}">
  <title>QBE</title>
</head>
<body>
  {% include 'navbar.html' %}
  <h4 id="qbe">QBE(Query-by-Frame)</h4>
  <div class="row" id="contant">
    <!--searchBox-->
    <div class="col-6" id="searchBox">
      <form>
        <div class="form-group row">
          <div class="col-sm-3"></div>
          <label class="col-sm-2">Frame</label>
          <div class="col-sm-6">
            <input type="text" class="form-control" id="imageName" value=""
            placeholder="2018-1-1-00-00.png" onchange="preview()">
          </div>
          <div class="col-sm-1"></div>
        </div>
        <div class="form-group row">
          <div class="col-sm-3"></div>
          <label class="col-sm-2">Dataset</label>
          <div class="col-sm-6">
            <input type="radio" name="dataset" id="level" value="level" checked onchange="preview()">
            <label for="level"> level </label>
            <span style="margin-left: 1em;margin-right: 1em;"> </span>
            <input type="radio" name="dataset" id="original" value="original"  onchange="preview()">
            <label for="original"> original </label>
          </div>
          <div class="col-sm-1"></div>
        </div>
      </form>
    </div>
    <!--imageBox-->
    <div class="col-6">
      <div class="row">
        <div class="col-sm-1"></div>
        <div class="col-sm-8 empty" id="imageBox">
          <img src="" alt="" id="image">
        </div>
        <div class="col-sm-3"></div>
      </div>
      
    </div>
    
  </div>
  <div class="row">
    <button type="submit" class="btn btn-primary" id="search">Search</button>
  </div>
  <script>
    function checkImage(imageSrc) {
      let img = new Image();
      img.onload = () => {
        document.getElementById('imageBox').classList.remove('empty');
        document.getElementById('image').src = imageSrc;
      }; 
      img.onerror = () => {
        console.log("bad");
        document.getElementById('imageBox').classList.add('empty');
        document.getElementById('image').src = "/static/emptyImage.svg";
      };
      img.src = imageSrc;
    }

    function preview() {
      console.log("pre");
      let path = "";
      let imageName = document.getElementById('imageName').value;
      if (document.getElementById('level').checked == true) {
        path = "/static/sis/" + imageName;
      } else {
        path = "/static/sis_origin/" + imageName;
      }
      checkImage(path);
    }

    preview()

  </script>

  
</body>
</html>